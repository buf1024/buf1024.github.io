<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>tcpdump on BUF1024!!!</title>
    <link>https://luoguochun.cn/tags/tcpdump/</link>
    <description>Recent content in tcpdump on BUF1024!!!</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <copyright>Copyletf buf2024</copyright>
    <lastBuildDate>Sat, 25 Jul 2015 14:26:04 +0000</lastBuildDate><atom:link href="https://luoguochun.cn/tags/tcpdump/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>tcpdump usage</title>
      <link>https://luoguochun.cn/post/2015-07-25-tcpdump-usage/</link>
      <pubDate>Sat, 25 Jul 2015 14:26:04 +0000</pubDate>
      
      <guid>https://luoguochun.cn/post/2015-07-25-tcpdump-usage/</guid>
      <description>&lt;h4 id=&#34;tcpdumpä½¿ç”¨æ–¹æ³•&#34;&gt;Tcpdumpä½¿ç”¨æ–¹æ³• &lt;a href=&#34;#tcpdump%e4%bd%bf%e7%94%a8%e6%96%b9%e6%b3%95&#34; class=&#34;anchor&#34;&gt;ğŸ”—&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;ï¼ˆ1ï¼‰&lt;strong&gt;ç¬¬ä¸€ç§æ˜¯å…³äºç±»å‹çš„å…³é”®å­—ä¸»è¦åŒ…æ‹¬&lt;code&gt;host&lt;/code&gt;ï¼Œ&lt;code&gt;net&lt;/code&gt;ï¼Œ&lt;code&gt;port&lt;/code&gt;&lt;/strong&gt;&lt;br&gt;
ä¾‹å¦‚ï¼š &lt;code&gt;host 210.27.48.2&lt;/code&gt;ï¼ŒæŒ‡æ˜ &lt;code&gt;210.27.48.2&lt;/code&gt;æ˜¯ä¸€å°ä¸»æœºï¼Œ&lt;code&gt;net 202.0.0.0&lt;/code&gt; æŒ‡æ˜&lt;code&gt;202.0.0.0&lt;/code&gt;æ˜¯ä¸€ä¸ªç½‘ç»œåœ°å€ï¼Œ&lt;code&gt;port 23&lt;/code&gt; æŒ‡æ˜ç«¯å£å·æ˜¯&lt;code&gt;23&lt;/code&gt;ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šç±»å‹ï¼Œç¼ºçœçš„ç±»å‹æ˜¯&lt;code&gt;host&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰ç¬¬äºŒç§æ˜¯ç¡®å®šä¼ è¾“æ–¹å‘çš„å…³é”®å­—ä¸»è¦åŒ…æ‹¬&lt;code&gt;src&lt;/code&gt; , &lt;code&gt;dst&lt;/code&gt; ,&lt;code&gt;dst or src&lt;/code&gt;, &lt;code&gt;dst and src&lt;/code&gt;&lt;br&gt;
è¿™äº›å…³é”®å­—æŒ‡æ˜äº†ä¼ è¾“çš„æ–¹å‘ï¼Œä¾‹å¦‚ï¼š&lt;code&gt;src 210.27.48.2&lt;/code&gt;ï¼ŒæŒ‡æ˜ipåŒ…ä¸­æºåœ°å€æ˜¯&lt;code&gt;210.27.48.2&lt;/code&gt; , &lt;code&gt;dst net 202.0.0.0&lt;/code&gt; æŒ‡æ˜ç›®çš„ç½‘ç»œåœ°å€æ˜¯&lt;code&gt;202.0.0.0&lt;/code&gt;ã€‚å¦‚æœæ²¡æœ‰æŒ‡æ˜æ–¹å‘å…³é”®å­—ï¼Œåˆ™ç¼ºçœæ˜¯&lt;code&gt;src or dst&lt;/code&gt;å…³é”®å­—ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ3ï¼‰ç¬¬ä¸‰ç§æ˜¯åè®®çš„å…³é”®å­—ï¼Œä¸»è¦åŒ…æ‹¬&lt;code&gt;fddi&lt;/code&gt;ï¼Œ&lt;code&gt;ip&lt;/code&gt;ï¼Œ&lt;code&gt;arp&lt;/code&gt;ï¼Œ&lt;code&gt;rarp&lt;/code&gt;ï¼Œ&lt;code&gt;tcp&lt;/code&gt;ï¼Œ&lt;code&gt;udp&lt;/code&gt;ç­‰ç±»å‹&lt;br&gt;
FddiæŒ‡æ˜æ˜¯åœ¨FDDI(åˆ†å¸ƒå¼å…‰çº¤æ•°æ®æ¥å£ç½‘ç»œ)ä¸Šçš„ç‰¹å®šçš„ç½‘ç»œåè®®ï¼Œå®é™…ä¸Šå®ƒæ˜¯&amp;quot;ether&amp;quot;çš„åˆ«åï¼Œfddiå’Œetherå…·æœ‰ç±»ä¼¼çš„æºåœ°å€å’Œç›®çš„åœ°å€ï¼Œæ‰€ä»¥å¯ä»¥å°†fddiåè®®åŒ…å½“ä½œetherçš„åŒ…è¿›è¡Œå¤„ç†å’Œåˆ†æã€‚å…¶ä»–çš„å‡ ä¸ªå…³é”®å­—å°±æ˜¯æŒ‡æ˜äº†ç›‘å¬çš„åŒ…çš„åè®®å†…å®¹ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šä»»ä½•åè®®ï¼Œåˆ™tcpdumpå°†ä¼šç›‘å¬æ‰€æœ‰åè®®çš„ä¿¡æ¯åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;é™¤äº†è¿™ä¸‰ç§ç±»å‹çš„å…³é”®å­—ä¹‹å¤–ï¼Œå…¶ä»–é‡è¦çš„å…³é”®å­—å¦‚ä¸‹ï¼š&lt;code&gt;gateway&lt;/code&gt;, &lt;code&gt;broadcast&lt;/code&gt;,&lt;code&gt;less&lt;/code&gt;,&lt;code&gt;greater&lt;/code&gt;,è¿˜æœ‰ä¸‰ç§é€»è¾‘è¿ç®—ï¼Œå–éè¿ç®—æ˜¯&lt;code&gt;not&lt;/code&gt; ï¼Œ&lt;code&gt;!&lt;/code&gt;ï¼Œä¸è¿ç®—æ˜¯&lt;code&gt;and&lt;/code&gt;ï¼Œ&lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt;;æˆ–è¿ç®— æ˜¯&lt;code&gt;or&lt;/code&gt;ï¼Œ&lt;code&gt;â”‚â”‚&lt;/code&gt;ï¼›è¿™äº›å…³é”®å­—å¯ä»¥ç»„åˆèµ·æ¥æ„æˆå¼ºå¤§çš„ç»„åˆæ¡ä»¶æ¥æ»¡è¶³äººä»¬çš„éœ€è¦ï¼Œä¸‹é¢ä¸¾å‡ ä¸ªä¾‹å­æ¥è¯´æ˜ã€‚æ™®é€šæƒ…å†µä¸‹ï¼Œç›´æ¥å¯åŠ¨tcpdumpå°†ç›‘è§†ç¬¬ä¸€ä¸ªç½‘ç»œç•Œé¢ä¸Šæ‰€æœ‰æµè¿‡çš„æ•°æ®åŒ…ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;A. tcpdump â€“i eth0 â€“c 10  
ä½¿ç”¨-iå‚æ•°æŒ‡å®štcpdumpç›‘å¬çš„ç½‘ç»œç•Œé¢ï¼Œè¿™åœ¨è®¡ç®—æœºå…·æœ‰å¤šä¸ªç½‘ç»œç•Œé¢æ—¶éå¸¸æœ‰ç”¨ï¼Œ
ä½¿ç”¨-cå‚æ•°æŒ‡å®šè¦ç›‘å¬çš„æ•°æ®åŒ…æ•°é‡ï¼Œ
ä½¿ç”¨-wå‚æ•°æŒ‡å®šå°†ç›‘å¬åˆ°çš„æ•°æ®åŒ…å†™å…¥æ–‡ä»¶ä¸­ä¿å­˜
 
B.æƒ³è¦æˆªè·ä¸»æœº172.16.14.107å’Œä¸»æœº172.16.14.27æˆ–172.16.14.99çš„é€šä¿¡ï¼Œä½¿ç”¨å‘½ä»¤ï¼šï¼ˆåœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨æ‹¬å·æ—¶ï¼Œä¸€å®šè¦ç”¨â€™\â€™
tcpdump host 172.16.14.107 and \ (172.16.14.27or172.16.14.99 \)

C.å¦‚æœæƒ³è¦è·å–ä¸»æœº172.16.14.107é™¤äº†å’Œä¸»æœº172.16.14.27ä¹‹å¤–æ‰€æœ‰ä¸»æœºé€šä¿¡çš„ipåŒ…ï¼Œä½¿ç”¨å‘½ä»¤ï¼š
tcpdump ip host 172.16.14.107 and ! 172.16.14.27

D.å¦‚æœæƒ³è¦è·å–ä¸»æœº172.16.14.107æ¥æ”¶æˆ–å‘å‡ºçš„telnetåŒ…ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š
tcpdump tcp port 23 host 172.16.14.107

E.å¯¹æœ¬æœºçš„udp 123 ç«¯å£è¿›è¡Œç›‘è§† ï¼ˆ123 ä¸ºntpçš„æœåŠ¡ç«¯å£ï¼‰
tcpdump udp port 123

F.ç³»ç»Ÿå°†åªå¯¹åä¸ºhostnameçš„ä¸»æœºçš„é€šä¿¡æ•°æ®åŒ…è¿›è¡Œç›‘è§†ã€‚ä¸»æœºåå¯ä»¥æ˜¯æœ¬åœ°ä¸»æœºï¼Œ
ä¹Ÿå¯ä»¥æ˜¯ç½‘ç»œä¸Šçš„ä»»ä½•ä¸€å°è®¡ç®—æœºã€‚ä¸‹é¢çš„å‘½ä»¤å¯ä»¥è¯»å–ä¸»æœºhostnameå‘é€çš„æ‰€æœ‰æ•°æ®ï¼š 
tcpdump -i eth0 src host hostname

G.ä¸‹é¢çš„å‘½ä»¤å¯ä»¥ç›‘è§†æ‰€æœ‰é€åˆ°ä¸»æœºhostnameçš„æ•°æ®åŒ…ï¼š 
tcpdump -i eth0 dst host hostname
#srcè¡¨ç¤ºæºï¼Œå³å‘é€
#dstè¡¨ç¤ºç›®çš„åœ°ï¼Œå³æ¥æ”¶

H.æˆ‘ä»¬è¿˜å¯ä»¥ç›‘è§†é€šè¿‡æŒ‡å®šç½‘å…³çš„æ•°æ®åŒ…ï¼š 
tcpdump -i eth0 gateway Gatewayname

I.å¦‚æœä½ è¿˜æƒ³ç›‘è§†ç¼–å€åˆ°æŒ‡å®šç«¯å£çš„TCPæˆ–UDPæ•°æ®åŒ…ï¼Œé‚£ä¹ˆæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š 
tcpdump -i eth0 host hostname and port 80

J.å¦‚æœæƒ³è¦è·å–ä¸»æœº172.16.14.107æ¥æ”¶æˆ–å‘å‡ºçš„telnetåŒ…ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š
tcpdump tcp port 23 host 172.16.14.107

K. å¦‚æœæˆ‘ä»¬åªéœ€è¦åˆ—å‡ºé€åˆ°80ç«¯å£çš„æ•°æ®åŒ…ï¼Œç”¨dst port 80ï¼›å¦‚æœæˆ‘ä»¬åªå¸Œæœ›çœ‹åˆ°è¿”å›80ç«¯å£çš„æ•°æ®åŒ…ï¼Œç”¨src port 80ã€‚ 
tcpdump â€“i eth0 host hostname and dst port 80  #ç›®çš„ç«¯å£æ˜¯80 æˆ–è€…
tcpdump â€“i eth0 host hostname and src port 80  #æºç«¯å£æ˜¯80, 80ç«¯å£ä¸€èˆ¬æ˜¯æä¾›httpçš„æœåŠ¡çš„ä¸»æœº
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;tcpdumpè¾“å‡ºæ ¼å¼:&lt;br&gt;
æ€»çš„çš„è¾“å‡ºæ ¼å¼ä¸ºï¼šç³»ç»Ÿæ—¶é—´ æ¥æºä¸»æœº.ç«¯å£ &amp;gt; ç›®æ ‡ä¸»æœº.ç«¯å£ æ•°æ®åŒ…å‚æ•°&lt;/p&gt;
&lt;p&gt;å¦‚æœè¦ç”¨wiresharkåˆ†ææ•°æ®ï¼Œé¡»åŠ ä¸Š&lt;code&gt;-s â€“w&lt;/code&gt;é€‰é¡¹ï¼Œå¦åˆ™wiresharkä¸èƒ½è¯†åˆ«æ–‡ä»¶æ ¼å¼ï¼š&lt;br&gt;
&lt;code&gt;tcpdump -i eth0 -c 100 -s 0 -w /home/data.pcap&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šå°±æ˜¯&lt;code&gt;BPF&lt;/code&gt;è¯­æ³•ï¼Œæ­¤è¯­æ³•åŒæ—¶é€‚ç”¨äºWIRESHARKè·å–æŠ¥æ–‡çš„è¯­æ³•ã€‚&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
