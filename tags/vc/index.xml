<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>vc on BUF1024!!!</title>
    <link>https://luoguochun.cn/tags/vc/</link>
    <description>Recent content in vc on BUF1024!!!</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Wed, 25 Jun 2014 13:00:43 +0000</lastBuildDate><atom:link href="https://luoguochun.cn/tags/vc/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>cæ„é€ å‡½æ•°</title>
      <link>https://luoguochun.cn/post/2014-06-25-c-constructor/</link>
      <pubDate>Wed, 25 Jun 2014 13:00:43 +0000</pubDate>
      
      <guid>https://luoguochun.cn/post/2014-06-25-c-constructor/</guid>
      <description>&lt;h3 id=&#34;æ„é€ å‡½æ•°&#34;&gt;æ„é€ å‡½æ•° &lt;a href=&#34;#%e6%9e%84%e9%80%a0%e5%87%bd%e6%95%b0&#34; class=&#34;anchor&#34;&gt;ğŸ”—&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;ä»»ä½•ä¸€ä»¬é¢å‘å¯¹è±¡è¯­è¨€é‡Œéƒ½ä¼šæ¶‰åŠæ„é€ å‡½æ•°è¿™ä¸€æ¦‚å¿µï¼Œåªæ˜¯å®ç°çš„æ–¹å¼å„æœ‰å·®å¼‚ã€‚éœ€è¦è¿™mainå‡½æ•°ä¹‹å‰æ‰§è¡Œä¸€æ®µä»£ç æ˜¯éå¸¸å®¹æ˜“çš„äº‹æƒ…ï¼Œåªéœ€è¦å£°æ˜ä¸€å¯¹è±¡çš„å…¨å±€å˜é‡ï¼Œåœ¨æ„é€ å‡½æ•°å¯ä»¥ä¸º&lt;em&gt;æ‰€æ¬²ä¸º&lt;/em&gt;å¹²ä½ æƒ³å¹²çš„äº‹æƒ…ã€‚ç„¶è€Œï¼Œå¯¹äºé¢å‘è¿‡ç¨‹çš„è¯­è¨€æ¯”å¦‚Cï¼Œéœ€è¦å®ç°å…¨å±€çš„æ„é€ å‡½æ•°å°±æ¯”è¾ƒå¥‡è‘©ã€‚å½“ç„¶gccä¼šæœ‰å¾ˆä¼˜é›…çš„è§£å†³æ–¹å¼ï¼ŒVCåˆ™çŒ¥çç‚¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¸ºä½•éœ€è¦è¿™ä¸ª&#34;&gt;ä¸ºä½•éœ€è¦è¿™ä¸ª &lt;a href=&#34;#%e4%b8%ba%e4%bd%95%e9%9c%80%e8%a6%81%e8%bf%99%e4%b8%aa&#34; class=&#34;anchor&#34;&gt;ğŸ”—&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;å…¶å®åœ¨mainå‡½æ•°é‡Œé¢è°ƒç”¨ä¸€ä¸‹å°±å¯ä»¥äº†ï¼Œæ˜¯çš„ï¼Œè¿™æ ·æ˜¯å¯ä»¥ï¼Œä½†æ˜¯å¯¹äºæ¡†æ¶çš„å®ç°æ¥è¯´ï¼Œè¿™å´æ˜¯ä¸å¤ªå¥½çš„ï¼Œå®¢æˆ·ä½¿ç”¨èµ·æ¥ä¸è‡ªç”±ã€‚å½“ç„¶ä¹Ÿå¯ä»¥è¯´ï¼Œæˆ‘æ˜¯å±Œä¸ï¼Œæˆ‘å¯ä»¥è£…é€¼ç‚¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¦‚ä½•å®ç°&#34;&gt;å¦‚ä½•å®ç° &lt;a href=&#34;#%e5%a6%82%e4%bd%95%e5%ae%9e%e7%8e%b0&#34; class=&#34;anchor&#34;&gt;ğŸ”—&lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;gccå®ç°&lt;br&gt;
gcc å®ç°æ˜¯éå¸¸ç®€å•çš„äº‹æƒ…ã€‚åœ¨å…¨å±€æ„é€ å‡½æ•°å‰å«ä»¥ä¸‹ç¼–è¯‘å™¨å±æ€§å³å¯ï¼š&lt;br&gt;
&lt;strong&gt;attribute&lt;/strong&gt;((constructor))&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;vcå®ç°
vcçš„å®ç°æ¯”è¾ƒå¥‡è‘©ï¼ŒVCæœ¬èº«æ²¡æœ‰ç±»ä¼¼Â·&lt;strong&gt;attribute&lt;/strong&gt;Â·è¿™æ ·çš„å±æ€§ï¼Œä½ éœ€è¦å°†å…¨å±€å‡½æ•°ç¼–è¯‘åˆ°æŸä¸ªç‰¹å®šçš„ä»£ç æ®µé‡Œé¢ã€‚MSDNå¯¹äºè¿™éƒ¨åˆ†æœ‰è¯¦ç»†çš„è¯´æ˜ï¼š&lt;a href=&#34;http://msdn.microsoft.com/en-us/library/bb918180.aspx&#34;&gt;CRT Initialization&lt;/a&gt;&lt;br&gt;
ç®€å•æ¥è¯´å°±æ˜¯å°†ä½ çš„å…¨å±€æ„é€ å‡½æ•°çš„å‡½æ•°æŒ‡é’ˆç¼–è¯‘åˆ°Â·.CRT$XCUÂ·æ®µé‡Œé¢ã€‚å¦‚ä½•ç¼–è¯‘åˆ°Â·.CRT$XCUÂ·æ®µï¼ŸVCæœ‰VCçš„è¯­æ³•ã€‚&lt;/p&gt;
&lt;p&gt;// å£°æ˜åœ¨æ®µÂ·.CRT$XCUÂ·é‡Œé¢ç”Ÿæˆä»£ç  &lt;br&gt;
#pragma section(&amp;quot;.CRT$XCU&amp;quot;,read) &lt;br&gt;
// å£°æ˜éœ€è¦è°ƒç”¨çš„å‡½æ•° &lt;br&gt;
__declspec(allocate(&amp;quot;.CRT$XCU&amp;quot;)) void (__cdecl *a)(void) = func; &lt;br&gt;
// è°ƒç”¨çš„å‡½æ•°å®ç° &lt;br&gt;
void func(void){}&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥ä¸Šå®ç°å¯ä»¥ç”¨ä¸‹é¢å®ç°ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#ifdef _MSC_VER    
#define __CCALL __cdecl    
#define __func__ __FUNCTION__    
#define snprintf _snprintf    
#pragma warning(disable:4996) // this is very violent    
#pragma section(&amp;quot;.CRT$XCU&amp;quot;,read)
#define __CONSTRCT(a, b)                                             \    
  void __CCALL __##a##__##b##__ ## 520hjm(void);                   \    
  __declspec(allocate(&amp;quot;.CRT$XCU&amp;quot;))                                 \    
  void (__CCALL * __ctor__##a##__##b##__ ## 520hjm)(void) =        \    
  __##a##__##b##__ ## 520hjm;    
#else    
#define __CCALL    
#define __CONSTRCT(a, b) __attribute__((constructor))    
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;é¢å¤–å‚è€ƒ&#34;&gt;é¢å¤–å‚è€ƒ &lt;a href=&#34;#%e9%a2%9d%e5%a4%96%e5%8f%82%e8%80%83&#34; class=&#34;anchor&#34;&gt;ğŸ”—&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;ä»¿ç…§&lt;a href=&#34;https://code.google.com/p/googletest/&#34;&gt;gtest&lt;/a&gt;çš„ç®€æ˜“å•å…ƒæµ‹è¯•&lt;a href=&#34;https://github.com/buf1024/ctest&#34;&gt;ctest&lt;/a&gt;å°±æ˜¯ç”¨çš„è¿™æ–¹é¢çš„çŸ¥è¯†ã€‚&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
